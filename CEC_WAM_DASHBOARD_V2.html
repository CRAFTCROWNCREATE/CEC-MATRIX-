// --- Core System Functions ---
const logArea = document.getElementById('log-output');

function addLog(message) {
    const timestamp = new Date().toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: false });
    const logEntry = document.createElement('div');
    logEntry.className = 'log-entry';
    logEntry.innerText = `[${timestamp}] ${message}`;
    
    // Add to top of log list
    if (logArea.firstChild) {
        logArea.insertBefore(logEntry, logArea.firstChild);
    } else {
        logArea.appendChild(logEntry);
    }
    
    // Auto-scroll to keep the latest message in view (optional, depending on display)
    // logArea.scrollTop = 0; 

    // Prune old logs to prevent memory overflow
    while (logArea.children.length > 50) {
        logArea.removeChild(logArea.lastChild);
    }
}

// --- System Initialization ---
window.onload = () => {
    // Attempt to load the true CORE (for security/separation)
    const coreUrl = document.getElementById('core-source').dataset.src;
    if (coreUrl) {
        // In a real environment, this would securely load or execute the binary core.
        // For the HTML shell, we'll just log the attempt.
        // fetch(coreUrl); 
        addLog("[SYS] CORE SOURCE CODE DEPLOYED.");
    }

    // --- Loop ---
    setInterval(() => {
        // Random Status Updates (Mimicking off-grid system checks)
        if (Math.random() > 0.9) {
            const messages = [
                "Checking integrity...",
                "Syncing with local timeline...",
                "Updating liquid value cache...",
                "Scanning for off-grid signals..."
            ];
            addLog(`[AUTO] ${messages[Math.floor(Math.random() * messages.length)]}`);
        }
        
        // Value Ticker Update (The 'Live Data')
        const baseVal = 1250000;
        const randomAdd = Math.floor(Math.random() * 500);
        document.getElementById('val-disp').innerText = (baseVal + randomAdd).toLocaleString() + "M";
    }, 5000); // Updates every 5 seconds

};
